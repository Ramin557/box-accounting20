{% extends "base.html" %}

{% block title %}Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯ - Ø³ÛŒØ³ØªÙ… Ø­Ø³Ø§Ø¨Ø¯Ø§Ø±ÛŒ{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{{ url_for('products') }}">Ù…Ø­ØµÙˆÙ„Ø§Øª</a></li>
<li class="breadcrumb-item active">Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯</li>
{% endblock %}

{% block content %}
<div class="row">
    <!-- Page Header -->
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>
                <i class="fas fa-box text-primary"></i>
                Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø­ØµÙˆÙ„ Ø¬Ø¯ÛŒØ¯
            </h2>
            <a href="{{ url_for('products') }}" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-right"></i>
                Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ù„ÛŒØ³Øª
            </a>
        </div>
    </div>
</div>

<!-- Product Form -->
<div class="row">
    <div class="col-lg-10 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle"></i>
                    Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­ØµÙˆÙ„
                </h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <div class="row">
                        <!-- Basic Information -->
                        <div class="col-12 mb-4">
                            <h6 class="text-primary border-bottom pb-2">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø§ÛŒÙ‡</h6>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="code" class="form-label">Ú©Ø¯ Ù…Ø­ØµÙˆÙ„ <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="code" name="code" required placeholder="BOX001" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                            <div class="form-text">Ú©Ø¯ Ù…Ø­ØµÙˆÙ„ Ø¨Ø§ÛŒØ¯ Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯ Ø¨Ø§Ø´Ø¯</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="name" name="name" required placeholder="Ø¬Ø¹Ø¨Ù‡ Ú©ÙˆÚ†Ú© Û²Û°Ã—Û±ÛµÃ—Û±Û°" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="category" class="form-label">Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</label>
                            <div class="input-group">
                                <select class="form-select" id="category" name="category" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                                    <option value="Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©">Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ú©ÙˆÚ†Ú©</option>
                                    <option value="Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙˆØ³Ø·">Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ØªÙˆØ³Ø·</option>
                                    <option value="Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯">Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯</option>
                                    <option value="Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡">Ø¬Ø¹Ø¨Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡</option>
                                </select>
                                <div class="input-group-append">
                                    <button class="btn btn-outline-primary btn-sm" type="button" title="Ø§ÙØ²ÙˆØ¯Ù† Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¬Ø¯ÛŒØ¯" style="background-color: #0d6efd; color: white; border-color: #0d6efd;">
                                        â• Ø§ÙØ²ÙˆØ¯Ù†
                                    </button>
                                    <button class="btn btn-outline-info btn-sm" type="button" title="ÙˆÛŒØ±Ø§ÛŒØ´ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§" style="background-color: #0dcaf0; color: black; border-color: #0dcaf0;">
                                        âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" type="button" title="Ø­Ø°Ù Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ" style="background-color: #dc3545; color: white; border-color: #dc3545;">
                                        ğŸ—‘ï¸ Ø­Ø°Ù
                                    </button>
                                </div>
                            </div>
                            <div class="form-text">Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¬Ø¯ÛŒØ¯ ØªØ§ÛŒÙ¾ Ú©Ù†ÛŒØ¯ ÛŒØ§ Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="unit" class="form-label">ÙˆØ§Ø­Ø¯ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ</label>
                            <div class="input-group">
                                <select class="form-select" id="unit" name="unit" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                                    <option value="Ø¹Ø¯Ø¯">Ø¹Ø¯Ø¯</option>
                                    <option value="Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…">Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…</option>
                                    <option value="Ù…ØªØ±">Ù…ØªØ±</option>
                                    <option value="Ø¨Ø³ØªÙ‡">Ø¨Ø³ØªÙ‡</option>
                                    <option value="Ú©Ø§Ø±ØªÙ†">Ú©Ø§Ø±ØªÙ†</option>
                                </select>
                                <div class="input-group-append">
                                    <button class="btn btn-outline-primary btn-sm" type="button" title="Ø§ÙØ²ÙˆØ¯Ù† ÙˆØ§Ø­Ø¯ Ø¬Ø¯ÛŒØ¯" style="background-color: #0d6efd; color: white; border-color: #0d6efd;">
                                        â• Ø§ÙØ²ÙˆØ¯Ù†
                                    </button>
                                    <button class="btn btn-outline-info btn-sm" type="button" title="ÙˆÛŒØ±Ø§ÛŒØ´ ÙˆØ§Ø­Ø¯Ù‡Ø§" style="background-color: #0dcaf0; color: black; border-color: #0dcaf0;">
                                        âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" type="button" title="Ø­Ø°Ù ÙˆØ§Ø­Ø¯" style="background-color: #dc3545; color: white; border-color: #dc3545;">
                                        ğŸ—‘ï¸ Ø­Ø°Ù
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-12 mb-3">
                            <label for="description" class="form-label">ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
                            <textarea class="form-control" id="description" name="description" rows="3" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª ØªÙØµÛŒÙ„ÛŒ Ù…Ø­ØµÙˆÙ„..." style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;"></textarea>
                        </div>
                        
                        <!-- Box Specifications -->
                        <div class="col-12 mb-4">
                            <h6 class="text-primary border-bottom pb-2">Ù…Ø´Ø®ØµØ§Øª Ø¬Ø¹Ø¨Ù‡</h6>
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <label for="length" class="form-label">Ø·ÙˆÙ„ (Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±)</label>
                            <input type="number" class="form-control" id="length" name="length" step="0.1" min="0" placeholder="20" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <label for="width" class="form-label">Ø¹Ø±Ø¶ (Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±)</label>
                            <input type="number" class="form-control" id="width" name="width" step="0.1" min="0" placeholder="15" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <label for="height" class="form-label">Ø§Ø±ØªÙØ§Ø¹ (Ø³Ø§Ù†ØªÛŒâ€ŒÙ…ØªØ±)</label>
                            <input type="number" class="form-control" id="height" name="height" step="0.1" min="0" placeholder="10" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-3 mb-3">
                            <label for="material_type" class="form-label">Ù†ÙˆØ¹ Ù…ÙˆØ§Ø¯</label>
                            <div class="input-group">
                                <select class="form-select" id="material_type" name="material_type" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                                    <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† Ù…Ø¹Ù…ÙˆÙ„ÛŒ">Ú©Ø§Ø±ØªÙ† Ù…Ø¹Ù…ÙˆÙ„ÛŒ</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† Ø¶Ø®ÛŒÙ…">Ú©Ø§Ø±ØªÙ† Ø¶Ø®ÛŒÙ…</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† ØµÙ†Ø¹ØªÛŒ">Ú©Ø§Ø±ØªÙ† ØµÙ†Ø¹ØªÛŒ</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† Ù…Ù‚ÙˆØ§ÛŒÛŒ">Ú©Ø§Ø±ØªÙ† Ù…Ù‚ÙˆØ§ÛŒÛŒ</option>
                                    <option value="Ù¾Ù„Ø§Ø³ØªÛŒÚ©">Ù¾Ù„Ø§Ø³ØªÛŒÚ©</option>
                                    <option value="Ú†ÙˆØ¨">Ú†ÙˆØ¨</option>
                                </select>
                                <div class="input-group-append">
                                    <button class="btn btn-outline-primary btn-sm" type="button" title="Ø§ÙØ²ÙˆØ¯Ù† Ù†ÙˆØ¹ Ù…ÙˆØ§Ø¯ Ø¬Ø¯ÛŒØ¯" style="background-color: #0d6efd; color: white; border-color: #0d6efd;">
                                        â• Ø§ÙØ²ÙˆØ¯Ù†
                                    </button>
                                    <button class="btn btn-outline-info btn-sm" type="button" title="ÙˆÛŒØ±Ø§ÛŒØ´ Ù†ÙˆØ¹ Ù…ÙˆØ§Ø¯" style="background-color: #0dcaf0; color: black; border-color: #0dcaf0;">
                                        âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" type="button" title="Ø­Ø°Ù Ù†ÙˆØ¹ Ù…ÙˆØ§Ø¯" style="background-color: #dc3545; color: white; border-color: #dc3545;">
                                        ğŸ—‘ï¸ Ø­Ø°Ù
                                    </button>
                                </div>
                            </div>
                        </div>
                                    <option value="Ú©Ø§Ø±ØªÙ† Ø¶Ø®ÛŒÙ…">Ú©Ø§Ø±ØªÙ† Ø¶Ø®ÛŒÙ…</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† ØµÙ†Ø¹ØªÛŒ">Ú©Ø§Ø±ØªÙ† ØµÙ†Ø¹ØªÛŒ</option>
                                    <option value="Ú©Ø§Ø±ØªÙ† Ù…Ù‚ÙˆØ§ÛŒÛŒ">Ú©Ø§Ø±ØªÙ† Ù…Ù‚ÙˆØ§ÛŒÛŒ</option>
                                    <option value="Ù¾Ù„Ø§Ø³ØªÛŒÚ©">Ù¾Ù„Ø§Ø³ØªÛŒÚ©</option>
                                    <option value="Ú†ÙˆØ¨">Ú†ÙˆØ¨</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Pricing -->
                        <div class="col-12 mb-4">
                            <h6 class="text-primary border-bottom pb-2">Ù‚ÛŒÙ…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ</h6>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="cost_price" class="form-label">Ù‚ÛŒÙ…Øª ØªÙ…Ø§Ù… Ø´Ø¯Ù‡ (ØªÙˆÙ…Ø§Ù†)</label>
                            <input type="number" class="form-control" id="cost_price" name="cost_price" min="0" step="100" placeholder="5000" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="selling_price" class="form-label">Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´ (ØªÙˆÙ…Ø§Ù†) <span class="text-danger">*</span></label>
                            <input type="number" class="form-control" id="selling_price" name="selling_price" min="0" step="100" required placeholder="8000" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <!-- Inventory -->
                        <div class="col-12 mb-4">
                            <h6 class="text-primary border-bottom pb-2">Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ</h6>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="current_stock" class="form-label">Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ</label>
                            <input type="number" class="form-control" id="current_stock" name="current_stock" min="0" value="0" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="min_stock_level" class="form-label">Ø­Ø¯Ø§Ù‚Ù„ Ù…ÙˆØ¬ÙˆØ¯ÛŒ</label>
                            <input type="number" class="form-control" id="min_stock_level" name="min_stock_level" min="0" value="0" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                            <div class="form-text">Ù‡Ø´Ø¯Ø§Ø± Ú©Ù… Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¯Ø± Ø§ÛŒÙ† Ø­Ø¯ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯</div>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="max_stock_level" class="form-label">Ø­Ø¯Ø§Ú©Ø«Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ</label>
                            <input type="number" class="form-control" id="max_stock_level" name="max_stock_level" min="1" value="1000" style="background-color: #2a2a4a !important; border: 1px solid #555 !important; color: #ffffff !important;">
                        </div>
                    </div>
                    
                    <hr>
                    
                    <!-- Form Actions -->
                    <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="fas fa-save"></i>
                            Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­ØµÙˆÙ„
                        </button>
                        
                        <a href="{{ url_for('products') }}" class="btn btn-outline-secondary btn-lg">
                            <i class="fas fa-times"></i>
                            Ø§Ù†ØµØ±Ø§Ù
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Auto-generate product code based on name
document.getElementById('name').addEventListener('input', function(e) {
    const name = e.target.value;
    const codeField = document.getElementById('code');
    
    if (!codeField.value && name) {
        // Simple code generation - take first letters and add numbers
        let code = 'BOX';
        const words = name.split(' ');
        if (words.length > 1) {
            code += words.slice(0, 2).map(w => w.substring(0, 1)).join('').toUpperCase();
        }
        code += String(Math.floor(Math.random() * 900) + 100);
        codeField.value = code;
    }
});

// Calculate profit margin
function updateProfitMargin() {
    const costPrice = parseFloat(document.getElementById('cost_price').value) || 0;
    const sellingPrice = parseFloat(document.getElementById('selling_price').value) || 0;
    
    if (costPrice > 0 && sellingPrice > 0) {
        const margin = ((sellingPrice - costPrice) / sellingPrice * 100).toFixed(1);
        const profit = sellingPrice - costPrice;
        
        // Show margin info (you can add a div to display this)
        console.log(`Profit Margin: ${margin}%, Profit: ${profit.toLocaleString()} ØªÙˆÙ…Ø§Ù†`);
    }
}

document.getElementById('cost_price').addEventListener('input', updateProfitMargin);
document.getElementById('selling_price').addEventListener('input', updateProfitMargin);

// Format numbers with thousands separator
function formatNumber(input) {
    input.addEventListener('blur', function(e) {
        const value = parseFloat(e.target.value);
        if (!isNaN(value)) {
            e.target.value = value.toLocaleString();
        }
    });
    
    input.addEventListener('focus', function(e) {
        const value = e.target.value.replace(/,/g, '');
        e.target.value = value;
    });
}

formatNumber(document.getElementById('cost_price'));
formatNumber(document.getElementById('selling_price'));
</script>
{% endblock %}